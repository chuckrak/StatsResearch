library(tidyverse)
pollution <- read.table('a.txt', header=TRUE)
pollution <- read.table('a.txt', header=TRUE)
View(pollution)
pollution <- read.csv('a.csv', header=TRUE)
View(pollution)
initial_model <- pollution %>% lm(Y ~ X1 + X2 + X3 + X4 + X5 + X6)
pollution <- read.csv('a.csv', header=TRUE)
View(pollution)
initial_model <- pollution %>% lm(Y ~ X1 + X2 + X3 + X4 + X5 + X6, .)
summary(initial_model)
significant_model <- pollution %>% lm(Y ~ X1 + X2 + X3)
significant_model <- pollution %>% lm(Y ~ X1 + X2 + X3, .)
summary(significant_model)
significant_model <- pollution %>% lm(Y ~ X1 + X2 + X3 + X4, .)
summary(significant_model)
significant_model <- pollution %>% lm(Y ~ X1 + X2 + X3, .)
summary(significant_model)
significant_model <- pollution %>% lm(Y ~ X2 + X3, .)
summary(significant_model)
df <- initial_model
df <- pollution
cor_matrix <- cor(df)
df <- pollution %>% select(Y, X1, X2, X3, X4, X5, X6)
cor_matrix <- cor(df)
# Create pairs plot with correlation coefficients
pairs(df, lower.panel = function(x, y, ...) {
points(x, y, ...)
text(0.5, 0.5, sprintf("%0.2f", cor_matrix[rownames(cor_matrix) == names(df)[y], colnames(cor_matrix) == names(df)[x]]), cex = 1.2)
})
pairs(df)
library(tidyverse)
df <- read.csv('data.csv')
df %>% mutate(NE = (Region == 'NE'))
df %>% mutate(NE = (Region == 'NE') * 1)
df %>% lm(Y ~ X2 + X3 + NE)
model <- df %>% lm(Y ~ X2 + X3 + NE, .)
df %>% mutate(NE = (Region == 'NE') * 1)
df <- df %>% mutate(NE = (Region == 'NE') * 1)
model <- df %>% lm(Y ~ X2 + X3 + NE, .)
summary(model)
plot(model)
plot <- plot(model)
?plot
?par
par(mfrow(2,2))
plot(model)
par(mfrow= c(2,2))
plot(model)
df <- df %>% mutate(X5NE = X5 * NE,
X6NE = X6 * NE)
interaction_A <- df %>% lm(Y ~ X2 + X3 + X5NE, .)
interaction_A <- df %>% lm(Y ~ X2 + X3 + X5NE, .)
plot(interaction_A)
interaction_A <- df %>% lm(Y ~ X2 + X3 + X5NE, .)
plot(interaction_A)
par(mfrow= c(2,2))
plot(interaction_A)
interaction_B <- df %>% lm(Y ~ X2 + X3 + NE + X6NE, .)
plot(interaction_B)
data <- read.csv('../p3/data.csv')
head(data)
data <- data %>% mutate(
'Female' = int(Gender == 'Male'),
'NormalLight' = int(Light == 'Normal Light')
)
library(tidyverse)
data <- data %>% mutate(
'Female' = int(Gender == 'Male'),
'NormalLight' = int(Light == 'Normal Light')
)
data <- data %>% mutate(
'Female:NormalLight' = Female * NormalLight,
'Female:Dosage' = Female * Dosage
)
data <- data %>% mutate(
'Female' = int(Gender == 'Male'),
'NormalLight' = int(Light == 'Normal Light')
)
data <- data %>% mutate(
'Female' = (int)Gender == 'Male',
data <- data %>% mutate(
'Female' = as.integer(Gender == 'Male'),
'NormalLight' = as.integer(Light == 'Normal Light')
)
data <- data %>% mutate(
'Female:NormalLight' = Female * NormalLight,
'Female:Dosage' = Female * Dosage
)
model <- data %>% lm(LH ~ Female + NormalLight + Dosage + Female:NormalLight + `Female:Dosage`)
model <- data %>% lm(LH ~ Female + NormalLight + Dosage + Female:NormalLight + `Female:Dosage`, .)
plot(model)
data <- data %>% mutate(
'Female' = as.integer(Gender == 'Male'),
'NormalLight' = as.integer(Light == 'Normal Light')
'LogLH' = log(LH)
data <- data %>% mutate(
'Female:NormalLight' = Female * NormalLight,
'Female:Dosage' = Female * Dosage
)
data <- data %>% mutate(
'Female' = as.integer(Gender == 'Male'),
'NormalLight' = as.integer(Light == 'Normal Light'),
'LogLH' = log(LH)
)
model <- data %>% lm(LogLH ~ Female + NormalLight + Dosage + Female:NormalLight + `Female:Dosage`, .)
plot(model)
data <- data %>% mutate(
'Female' = as.integer(Gender == 'Male'),
'NormalLight' = as.integer(Light == 'Normal Light'),
'DosageFactor' = as.factor(Dosage),
'LogLH' = log(LH)
)
data <- data %>% mutate(
'Female:NormalLight' = Female * NormalLight,
'Female:Dosage' = Female * Dosage
)
head(data)
View(data)
data <- data %>% mutate(
'Female:NormalLight' = Female * NormalLight,
'Female:DosageFactor' = Female * DosageFactor
)
data <- data %>% mutate(
'Female:NormalLight' = Female * NormalLight,
'Female:DosageFactor' = Female * DosageFactor
)
data <- data %>% mutate(
'Female:NormalLight' = Female * NormalLight,
'Female:DosageFactor' = Female * Dosage
)
data <- read.csv('../p3/data.csv')
head(data)
data <- data %>% mutate(
'Female' = as.integer(Gender == 'Male'),
'NormalLight' = as.integer(Light == 'Normal Light'),
'DosageFactor' = as.factor(Dosage),
'LogLH' = log(LH)
)
data <- data %>% mutate(
'Female:NormalLight' = Female * NormalLight,
'Female:Dosage' = Female * Dosage
)
head(data)
model <- data %>% lm(LogLH ~ Female + NormalLight + DosageFactor + Female:NormalLight + `Female:Dosage`, .)
summary(model)
plot(model)
model <- data %>% lm(LH ~ Female + NormalLight + DosageFactor + Female:NormalLight + `Female:Dosage`, .)
summary(model)
plot(model)
logmodel <- data %>% lm(LogLH ~ Female + NormalLight + DosageFactor + Female:NormalLight + `Female:Dosage`, .)
plot(logmodel)
# Sample data
x1 <- factor(rep(1:3, each = 4))
x2 <- factor(rep(1:2, times = 6))
y <- c(2, 4, 5, 3, 6, 8, 7, 9, 10, 11, 13, 15)
# Interaction plot
interaction.plot(x1, x2, y, type = "b", col = c("blue", "red"), pch = c(1, 2), legend = TRUE)
